# Progreso 2025-12-22

- Integrado el parser de argumentos `argparse` (v3.2, MIT) en el binario `rectai-tracker`, reemplazando el parseo manual de `argv` en `tracker/src/main.cpp`.
- Añadida la dependencia vendorizada en `external/argparse` y actualizados los includes en `tracker/CMakeLists.txt` para exponer `argparse/argparse.hpp`.
- Verificado que el proyecto compila correctamente en modo Debug con la nueva ruta de includes y que las opciones de línea de comandos del tracker mantienen el mismo contrato lógico (modo, cámara, resolución, fps, flags de depuración/OSC y filtros).

- Arreglado el mapeo de modos de filtro en `AudioEngine` para que los ids de `FilterModule` (0=lowpass, 1=bandpass, 2=highpass) coincidan con los tipos de `StateVariableTPTFilter` tanto en filtros por voz como en los buses estéreo (Sampleplay y Loop).
- Añadido un log de depuración en `MainComponent_AudioRouting` (solo en builds Debug) que reporta qué módulo `Filter` y qué parámetros (modo y cutoff) se están aplicando a los buses de Sampleplay y Loop, para poder diagnosticar fácilmente problemas de routing de filtros desde la escena.
- Actualizado el uso de los filtros de bus en `AudioEngine` para que se activen cuando `cutoffHz>0` (independientemente del modo), de forma que el modo 0 (lowpass) también se procese correctamente en Sampleplay y Loop.
- Hecho permanente el log de routing de filtros en `MainComponent_AudioRouting` (ya no está protegido por `NDEBUG`) para poder ver en Release qué filtro y qué parámetros se están usando en los buses globales mientras se estabiliza esta parte del motor.

- Extendida la lógica de routing de filtros globales en `MainComponent_AudioRouting` para que el bus de Loop use la misma heurística que Sampleplay: se selecciona el `FilterModule` más cercano con conexión Loop→Filter activa (no muteada, dentro del área musical y respetando conos dinámicos) y se aplican sus parámetros (`freq`, `q`, modo) al bus estéreo de Loop vía `AudioEngine::setLoopFilter`.
- Añadido un log compacto `[rectai-core][filter-routing]` que reporta, en cada tick de audio, qué módulo de filtro y qué parámetros efectivos se están aplicando a los buses de Sampleplay y Loop, para poder depurar escenas donde el filtro parece no afectar a Sampleplay/Loop a pesar de estar conectado visualmente.

- Ajustada la lógica de dibujo de radiales en `MainComponent_Paint` para que los módulos `Loop` se comporten como los generadores: cuando un Loop alimenta a otro módulo de audio (por ejemplo Loop→Filter) a través de una conexión activa, se oculta su radial directo al master y solo se mantiene visible la radial del módulo de destino. Esto evita el efecto visual de “doble línea” saliendo del Loop cuando está encadenado con un filtro.
- Mejorada la visualización de waveforms para cadenas Loop→Filter: ahora las conexiones Loop→X sin tap dedicado reutilizan el historial de waveform por-módulo de Loop tanto en los segmentos Loop→Filter como en las radiales agregadas de los módulos consumidores (p.ej. Filter). De este modo, cuando un filtro recibe audio únicamente desde uno o varios Loop, tanto la conexión como la radial del filtro muestran la actividad del loop en lugar de quedarse como líneas planas.
